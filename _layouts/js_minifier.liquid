{%- comment -%} Удаляем однострочные комментарии {%- endcomment -%}
{%- assign contentArray = content | split: "
" -%}
{%- assign content = "" -%}
{%- for part in contentArray -%}
	{%- assign aux = part | remove: "://" | split: "//" -%}
	{%- if aux.size == 2 -%}
		{%- assign aux = aux[1] | prepend: "//" -%}
		{%- assign aux = part | remove: aux -%}
		{%- assign content = content | append: aux | append: "
" -%}
	{%- else -%}
		{%- assign content = content | append: part | append: "
" -%}
	{%- endif -%}
{%- endfor -%}
{%- comment -%} Удаляем многострочные комментарии {%- endcomment -%}
{%- assign new_comment_tag = "2e57la4G82XMQr9K" -%}
{%- assign content = content | replace: "/*", new_comment_tag | replace: "*/", new_comment_tag -%}
{%- assign contentArray = content | split: new_comment_tag -%}
{%- assign content = "" -%}
{%- for part in contentArray -%}
	{%- assign mod = forloop.index | modulo: 2 -%}
	{%- if mod != 0 -%}
		{%- assign content = content | append: part -%}
	{%- endif -%}
{%- endfor -%}
{%- comment -%} Маркируем участки, кода со строками {%- endcomment -%}
{%- assign marker = "2e57la4G82XMQr9K" -%}
{%- assign aux = marker | append: '"' -%}
{%- assign content = content | replace: '"', aux -%}
{%- assign aux = marker | append: "'" -%}
{%- assign content = content | replace: "'", aux -%}
{%- assign aux = marker | append: "`" -%}
{%- assign content = content | replace: "`", aux -%}

{%- assign contentArray = content | split: marker -%}
{%- assign content = "" -%}
{%- assign simbols = "= + - / * , % > < : ; ( ) { } [ ]" | split: " " -%} {%- comment -%} Удаляем пробелы вокруг этих символов {%- endcomment -%}
{%- for part in contentArray -%}
	{%- assign mod = forloop.index | modulo: 2 -%}
	{%- if mod == 1 -%}
		{%- comment -%} Удаляем табуляции и переносы строк {%- endcomment -%}
		{%- assign partModified = part | remove: "	" | remove: "
"-%}
		{%- comment -%} Удаляем двойные пробелы {%- endcomment -%}
		{%- assign partModified_size = partModified | size -%}
		{%- for i in (1 .. 100) -%}
			{%- assign partModified = partModified | remove: "  " -%}
			{%- if partModified.size == partModified_size -%}
				{%- break -%}
			{%- else -%}
				{%- assign partModified_size = partModified | size -%}
			{%- endif -%}
		{%- endfor -%}
		{%- comment -%} Удаляем пробелы вокруг символов из simbols {%- endcomment -%}
		{%- for s in simbols -%}
			{%- assign aux = s | append: " " -%}
			{%- assign partModified = partModified | replace: aux, s -%}
			{%- assign aux = s | prepend: " " -%}
			{%- assign partModified = partModified | replace: aux, s -%}
		{%- endfor -%}
		{%- assign content = content | append: partModified -%}
	{%- else -%}
		{%- assign content = content | append: part -%}
	{%- endif -%}
{%- endfor -%}
{{ content }}